---
title: 配置对象引用跟踪
description: 配置对象引用跟踪
keywords:
- 对象引用跟踪，配置
ms.date: 05/23/2017
ms.localizationpriority: medium
ms.openlocfilehash: a8f196ffd7de002064633320012e0e9728f4ae25
ms.sourcegitcommit: 418e6617e2a695c9cb4b37b5b60e264760858acd
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 12/07/2020
ms.locfileid: "96818653"
---
# <a name="configuring-object-reference-tracing"></a>配置对象引用跟踪


你可以使用 Gflags 来启用、禁用和配置 Windows 的对象引用跟踪功能。 对象引用跟踪记录对象引用计数器递增或递减时的顺序堆栈跟踪。 跟踪有助于检测对象引用错误，包括双重取消引用、引用失败和取消引用对象。 只有 Windows Vista 和更高版本的 Windows 支持此功能。 有关此功能的详细信息，请参阅 [对象引用跟踪](object-reference-tracing.md)。

**启用对象引用跟踪**

1.  在 "Gflags" 对话框中，选择 " **系统注册表** " 选项卡或 " **内核标志** " 选项卡。

2.  在对象引用跟踪部分，选择 " **启用**"。

    必须将跟踪限制为具有指定池标记的对象、指定进程创建的对象或两者。

3.  若要将跟踪限制为具有特定池标记的对象，请键入池标记名称。 若要列出多个池标记，请使用分号 (; ) 分隔池标记。 列出多个池标记时，跟踪包括具有任何指定的池标记的对象。 池标记区分大小写。

    例如，Fred;Tag1.

4.  若要将跟踪限制为特定进程创建的对象，请键入进程的映像名称。 您只能指定一个映像文件名。

    如果同时指定了池标记和进程，则跟踪包含由具有任何指定的池标记的进程创建的对象。

5.  若要在销毁跟踪对象之后保留跟踪，请选择 " **永久**"。

    当你选择 " **永久**" 时，跟踪将一直保留，直到你禁用对象引用跟踪或关闭或重新启动 Windows。

6.  单击 **“应用”** 或 **“确定”**。

以下屏幕截图显示在 " **内核标志** " 选项卡上启用的对象引用跟踪。

![显示在 "内核标志" 选项卡上启用对象引用跟踪的屏幕截图](images/gflags-obj.png)

此跟踪将仅包括由具有池标记 **Fred** 或 **Tag1** 的 notepad.exe 进程创建的对象。 由于这是一个运行时 (内核标志) 设置，因此跟踪会立即启动。 如果是注册表设置，则必须重新启动 Windows 才能启动跟踪。

**禁用对象引用跟踪**

1.  在 "Gflags" 对话框中，选择 " **系统注册表** " 选项卡或 " **内核标志** " 选项卡。对象引用跟踪将仅在 windows Vista 和更高版本的 windows 中出现在后一选项卡上。

2.  在 "对象引用跟踪" 部分中，清除 " **启用** " 复选框。

 

 





