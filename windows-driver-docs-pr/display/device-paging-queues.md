---
title: 设备分页队列
description: 视频内存管理器公开的各种服务可能需要很少的时间才能完成。
ms.date: 04/20/2017
ms.localizationpriority: medium
ms.openlocfilehash: fecafa1d33281025c90e9fe699fcbba9fca42990
ms.sourcegitcommit: 418e6617e2a695c9cb4b37b5b60e264760858acd
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 12/07/2020
ms.locfileid: "96809515"
---
# <a name="device-paging-queues"></a>设备分页队列


视频内存管理器公开的各种服务可能需要很少的时间才能完成。 例如，在驻留分配的情况下，可能需要将分配内容从页面文件中恢复到很长时间内。 保留图形处理单元 (GPU) 虚拟地址或将虚拟地址映射到已存在的分配不太昂贵，但仍涉及到需要在分页引擎上排队的即时页面表更新，并可能需要一小段时间才能完成。

视频内存管理器不会强制请求这些服务的线程等待完成，而是使用异步队列来实现这些服务。 此异步队列称为设备分页队列。

每个图形设备都有一个专用分页队列，其中的各个视频内存管理器请求将排队等待视频内存管理器线程池用于维护。 设备分页防护对象与队列相关联，每个操作都分配有一个唯一的防护值，在视频内存管理器完成操作时，会收到信号。 视频内存管理器可以立即执行的操作会将设备分页围栏值返回为零。

设备分页防护是常规监视的隔离对象，用户模式驱动程序可以在 CPU 或 GPU 上等待这些视频内存管理器服务。

通常，用户模式驱动程序希望尽可能推送同步，并在上下文依赖于所请求的视频内存管理器操作之前，将 GPU 等待排队到上下文中。 例如，在为 *磁贴资源* 保留虚拟地址后，用户模式驱动程序必须确保等待保留操作完成，然后才能开始访问磁贴资源的虚拟地址范围。

若要获取对设备分页防护对象的引用，请将新的 **GetDevicePagingFenceObjectCb** 设备驱动程序接口 (DDI) 添加到用户模式驱动程序中。 具体语句如下所示：

![设备分页队列](images/device-paging-queues.1.png)

 

 





