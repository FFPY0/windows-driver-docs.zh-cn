---
title: 网络重定向程序的设计和性能
description: 网络重定向程序的设计和性能
keywords:
- 网络重定向 WDK，性能
- 重定向程序驱动程序 WDK，性能
- 性能 WDK 网络重定向器
- 线速网络重定向程序
- 带宽 WDK 网络重定向器
ms.date: 04/20/2017
ms.localizationpriority: medium
ms.openlocfilehash: ac765474eab5817ea19d96a74bee8dab5e8b5eae
ms.sourcegitcommit: 418e6617e2a695c9cb4b37b5b60e264760858acd
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 12/07/2020
ms.locfileid: "96827153"
---
# <a name="network-redirector-design-and-performance"></a>网络重定向程序的设计和性能


## <span id="ddk_network_redirector_design_and_performance_if"></span><span id="DDK_NETWORK_REDIRECTOR_DESIGN_AND_PERFORMANCE_IF"></span>


可以通过两种不同的路径在网络重定向器中实现高性能。 第一种方法是将网络快速转到所有其他方法。 第二种方法尝试使用复杂的技术来最大程度地减少网络操作，这些操作经常会耗费时间，并使用不足的网络资源 (可用带宽，如) 。 当开发人员第一次不成功时，通常会转向第二种方法。

尽管从不折扣短代码路径的优点，但当系统操作不会遇到一些基本瓶颈时，"即用即用" 方法将提供更好的性能。 例如，假设有一个 10 mb 的以太网网络，实际传输速率限制为 1.25 MB/秒。 虽然这比某些磁盘速度更快，但它仍比内存访问速度要慢得多。 出于此原因，在许多情况下，提供经常访问的数据的内存中缓存的系统将提供更好的性能。 相反，如果客户端上的网络重定向程序一定尝试在不利情况下进行缓存，性能可能会降低。 例如，如果缓存管理器依赖于基于 x86 的硬件的页粒度，则这可能意味着将读取和写入完整的 4 KB 块，以响应应用程序启动的每个32字节写入。 很显然，若要获得最佳性能，网络重定向程序必须实施复杂的缓存管理策略，但也必须进行同样的准备，以便动态确定是否使用它们。 而且，如果禁用了缓存，则必须准备好网络重定向程序，以便为网络运行。

在 CPU 饱和服务器的情况下，会提供第二个示例。 如果没有采取措施来缓解服务器上的拥塞，则远程文件系统的性能可能会受到严重的阻碍。 例如，"饱和度" 条件下的服务器可能会比卸载的服务器更容易丢弃数据包。 建议客户端网络重定向程序将发送的数据包速度降到一并降低丢弃数据包的概率。 更好的是，重定向程序可能会采取措施来尝试将多个操作合并到一个数据包中。 结合操作，使服务器获取每个数据包的更多操作都是饱和服务器的一种入选。

如果系统使用的网络模式不适用于流量类型和可能的网络条件，则还会降低性能。 经验表明，在使用基于数据报的模式和对小型 i/o 请求提供更好的性能之间可能的相关性。 这并不清楚这种改善是否是在整个板上，还是仅适用于数据报交付的概率非常高的方案。 但可用数据意味着除面向连接的模式外，还可以实现 "无连接" 模式。 理想的情况是网络重定向程序，网络协议将支持这两种模式并可供使用，因此重定向程序可以动态选择应如何传输流量。

最后，如果在操作过程中获得的适当数据可用于作出明智的决策，则性能可能会得到增强。 在 Windows 中有很多这样的示例。 例如，缓存管理器保留了读取命令的简短历史记录，并跟踪缓存命中数和未命中数，用于指导预读计划的决策。 另一个示例可能是使用 "环境信息" 进行决策。 文件名、共享名称或用户或管理员可能有可显著提高性能的信息。 例如，通过只更改缓存大小参数来捕获正在使用的数据文件，有时可能会对响应进行优化，从而提高性能。 某些情况下的访问模式的 "环境知识" 可能用于建议动态更改 (提示) 以提高性能。

 

 




