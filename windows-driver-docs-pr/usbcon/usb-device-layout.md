---
description: USB 设备通过配置、接口、备用设置和终结点定义其功能和功能。
title: USB 设备布局
ms.date: 04/20/2017
ms.localizationpriority: medium
ms.openlocfilehash: d8ddab071b7e29f8495e9a41456a417a4824b013
ms.sourcegitcommit: 10fecd036370f5eccb538004c5bec1fdd18c3275
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 01/12/2021
ms.locfileid: "98124233"
---
# <a name="usb-device-layout"></a>USB 设备布局


通用串行总线 (USB) 设备通过配置、接口、备用设置和终结点定义其功能和功能。 本主题对这些概念进行了高级概述。

*USB 配置* 定义设备的功能，主要是其强大功能和接口。 设备可以有多个配置，但一次只能有一个处于活动状态。 USB 驱动程序堆栈不会选择活动配置，但可能由应用程序、驱动程序、设备驱动程序启动。 设备驱动程序将选择一个活动配置。

配置可以有一个或多个用于定义设备功能的 *USB 接口* 。 通常，函数和接口之间存在一对一的相关性。 但是，某些设备公开了多个与一个函数相关的接口。 在这种情况下，设备可以具有接口关联描述符 (IAD) 。 IAD 将属于特定函数的接口组合在一起。

每个接口都包含一个或多个 *终结点，这些终结点* 用于将数据传入和传出设备。 此外，接口还包含 *替代设置* ，用于定义与接口关联的函数的带宽要求。 若要求和，一组终结点构成一个接口，一组接口构成设备中的配置。

那么，选择活动配置是什么意思？ 在设备初始化过程中，USB 设备的设备驱动程序必须选择配置、此配置中的一个或多个或接口，以及每个接口的备用设置。 大多数 USB 设备不提供多个接口或多个备用设置。 例如，OSR USB FX2 Learning 工具包设备有一个接口，其中包含一个备用设置和三个终结点。 有关学习工具包的详细信息，请参阅 [OSR Online （联机](https://www.osronline.com/)）。

**单接口设备**

此图显示了具有单个接口的设备配置：

![单接口设备的 usb 设备布局](images/device-layout-single.png)

在此示例中，关系图显示了称为 " *默认终结点*" 的终结点0。 所有 USB 设备都必须有一个默认终结点用于控制传输 (请参阅 [USB Control Transfer](usb-control-transfer.md)) 。 配置0具有一个接口： Interface 0，其中包含一个备用设置。 备用设置0使用接口中的所有三个终结点。

**多接口设备**

对于多功能设备，设备具有多个接口。 若要使用特定函数或接口，客户端驱动程序将选择接口和关联的备用设置。 请考虑使用多功能 USB 设备，例如网络摄像机。 设备具有两个功能：视频捕获 (相机) 和音频输入 (麦克风) 。 设备在视频接口中定义用于流式传输视频的终结点。 设备在单独的接口中具有另一个终结点，该终结点通过麦克风获取音频输入。 设备的配置包括这两个接口。

此图显示了网络摄像机设备的配置：

![多个接口设备的设备布局](images/device-descriptors-multi.png)

在此示例中，关系图显示默认终结点。 配置0具有两个接口： Interface 0 和 Interface 1。 接口0具有三个替代设置。 在任何给定时间，只有一个备用设置处于活动状态。 请注意，替代设置0不使用终结点，而备用设置1和2使用终结点1。 通常，视频摄像机使用 *同步终结点* 进行流式处理。 对于这种类型的终结点，在使用终结点时，会在总线上保留带宽。 当照相机未流式传输视频时，客户端驱动程序可以选择备用设置0来节省带宽。 当网络摄像机是流式传输视频时，客户端驱动程序可以切换为备用设置1或备用设置2，这将提供更高的质量级别并消耗增加的总线带宽。 接口1具有两个替代设置。 类似于接口0，备用设置0不使用终结点。 替换设置1定义为使用终结点1。

终结点不能在配置中的两个接口之间共享。 设备使用终结点地址来确定数据传输或终结点操作的目标终结点，如管道重置。 所有这些操作都由主机启动。

开始使用设备之前，请获取有关设备布局的信息。 [USBView](../debugger/usbview.md) 是一个应用程序，它使你能够浏览所有 USB 控制器和连接到它们的 usb 设备。 对于每个连接的设备，你可以查看设备、配置、接口和终结点描述符，以了解有关设备功能的信息。

接下来，请参阅 [标准 USB 描述符](standard-usb-descriptors.md)。

## <a name="related-topics"></a>相关主题
[适用于所有 USB 开发人员的概念](usb-concepts-for-all-developers.md)